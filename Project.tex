% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={BM2515/2507 Project},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{BM2515/2507 Project}
\author{}
\date{\vspace{-2.5em}Due Date: 11:59pm, 26 Apr, 2025}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'tidyverse' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## Warning: package 'readr' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 4.4.3
\end{verbatim}

\begin{verbatim}
## -- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --
## v dplyr     1.1.4     v readr     2.1.5
## v forcats   1.0.0     v stringr   1.5.1
## v ggplot2   3.5.2     v tibble    3.2.1
## v lubridate 1.9.3     v tidyr     1.3.1
## v purrr     1.0.2     
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## i Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyr)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{customer\_demographics }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Customer\_demographics.csv"}\NormalTok{)}
\NormalTok{sales\_data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Sales.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 1 Based on the customer demographics data, describe the customers.}

\FunctionTok{summary}\NormalTok{(customer\_demographics)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Age          Education        Income         Female   
##  Min.   :20.00   Min.   :1.00   Min.   :4100   Min.   :0.0  
##  1st Qu.:28.00   1st Qu.:2.00   1st Qu.:4300   1st Qu.:0.0  
##  Median :30.00   Median :2.00   Median :5300   Median :0.5  
##  Mean   :30.57   Mean   :1.98   Mean   :5199   Mean   :0.5  
##  3rd Qu.:33.00   3rd Qu.:2.00   3rd Qu.:5800   3rd Qu.:1.0  
##  Max.   :44.00   Max.   :3.00   Max.   :6500   Max.   :1.0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Education, }
                                          \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{), }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{))}

\CommentTok{\# Average income by education level}
\FunctionTok{aggregate}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Income,}
          \AttributeTok{by =} \FunctionTok{list}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Education),}
          \AttributeTok{FUN =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         Group.1        x
## 1   High School 4224.324
## 2 Undergraduate 5270.886
## 3  Postgraduate 6094.118
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Average age by education level}
\FunctionTok{aggregate}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Age,}
          \AttributeTok{by =} \FunctionTok{list}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Education),}
          \AttributeTok{FUN =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         Group.1        x
## 1   High School 34.16216
## 2 Undergraduate 28.83544
## 3  Postgraduate 30.70588
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{highschool\_number }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Education[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"High School"}\NormalTok{])}
\NormalTok{highschool\_number}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 37
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{undergraduate\_number }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Education[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"Undergraduate"}\NormalTok{])}
\NormalTok{undergraduate\_number}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 79
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{postgraduate\_number }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(customer\_demographics}\SpecialCharTok{$}\NormalTok{Education[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"Postgraduate"}\NormalTok{])}
\NormalTok{postgraduate\_number}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 34
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Female}
\NormalTok{no\_highsch\_female }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(customer\_demographics[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"High School"} \SpecialCharTok{\&}\NormalTok{ customer\_demographics}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, ])}
\NormalTok{no\_undergrad\_female }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(customer\_demographics[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"Undergraduate"} \SpecialCharTok{\&}\NormalTok{ customer\_demographics}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, ])}
\NormalTok{no\_postgrad\_female }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(customer\_demographics[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"Postgraduate"} \SpecialCharTok{\&}\NormalTok{ customer\_demographics}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, ])}

\CommentTok{\# Male}
\NormalTok{no\_highsch\_male }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(customer\_demographics[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"High School"} \SpecialCharTok{\&}\NormalTok{ customer\_demographics}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, ])}
\NormalTok{no\_undergrad\_male }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(customer\_demographics[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"Undergraduate"} \SpecialCharTok{\&}\NormalTok{ customer\_demographics}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, ])}
\NormalTok{no\_postgrad\_male }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(customer\_demographics[customer\_demographics}\SpecialCharTok{$}\NormalTok{Education }\SpecialCharTok{==} \StringTok{"Postgraduate"} \SpecialCharTok{\&}\NormalTok{ customer\_demographics}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, ])}

\CommentTok{\# Output each count}
\NormalTok{no\_highsch\_female}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 13
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{no\_undergrad\_female}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 41
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{no\_postgrad\_female}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{no\_highsch\_male}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 24
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{no\_undergrad\_male}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 38
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{no\_postgrad\_male}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 13
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 2.1 Do female customers purchase more on average than male customers?}
\NormalTok{sales\_data }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Sales.csv"}\NormalTok{)}

\CommentTok{\# Refactor Education}
\NormalTok{sales\_data}\SpecialCharTok{$}\NormalTok{Education }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(}
\NormalTok{  sales\_data}\SpecialCharTok{$}\NormalTok{Education,}
  \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{),}
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)}
\NormalTok{)}

\FunctionTok{head}\NormalTok{(sales\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Date CustomerID Price Promotion Age     Education Income Female Sales Return
## 1    1          1   4.9         0  35   High School   4200      1     8      1
## 2    1          2   4.9         0  30   High School   4200      0     8      1
## 3    1          3   4.9         0  32   High School   4200      0    12      0
## 4    1          4   4.9         0  31   High School   4200      0     9      0
## 5    1          5   4.9         0  36   High School   4200      0     9      0
## 6    1          6   4.9         0  39 Undergraduate   4400      0    12      0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{average\_male\_sales }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(sales\_data}\SpecialCharTok{$}\NormalTok{Sales[sales\_data}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{0}\NormalTok{], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{average\_female\_sales }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(sales\_data}\SpecialCharTok{$}\NormalTok{Sales[sales\_data}\SpecialCharTok{$}\NormalTok{Female }\SpecialCharTok{==} \DecValTok{1}\NormalTok{], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{print}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Female =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{Avg =} \FunctionTok{c}\NormalTok{(average\_female\_sales,average\_male\_sales)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Female      Avg
## 1      0 9.636800
## 2      1 9.220267
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 2.2 Do customers with different education levels show different purchase patterns?}
\NormalTok{avg\_sales\_edu }\OtherTok{\textless{}{-}} \FunctionTok{aggregate}\NormalTok{(}
\NormalTok{  Sales }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Education,}
  \AttributeTok{data =}\NormalTok{ sales\_data,}
  \AttributeTok{FUN  =}\NormalTok{ mean}
\NormalTok{)}
\FunctionTok{print}\NormalTok{(}\StringTok{"Average sales by education level:"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Average sales by education level:"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(avg\_sales\_edu)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Education    Sales
## 1   High School 9.094054
## 2 Undergraduate 9.502025
## 3  Postgraduate 9.621765
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 2.3 Is the promotion effective? If so, how does it affect female and male customers differently?}
\NormalTok{sales\_data}\SpecialCharTok{$}\NormalTok{Education }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(sales\_data}\SpecialCharTok{$}\NormalTok{Education)}
\NormalTok{reg }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Sales }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Price }\SpecialCharTok{+}\NormalTok{ Promotion }\SpecialCharTok{+}\NormalTok{ Age }\SpecialCharTok{+}\NormalTok{ Education }\SpecialCharTok{+}\NormalTok{ Income }\SpecialCharTok{+}\NormalTok{ Female, }\AttributeTok{data =}\NormalTok{ sales\_data)}
\FunctionTok{summary}\NormalTok{(reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Sales ~ Price + Promotion + Age + Education + Income + 
##     Female, data = sales_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.0672 -1.3370 -0.0436  1.4168  7.0909 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(>|t|)    
## (Intercept)             9.905e+00  5.352e-01  18.506  < 2e-16 ***
## Price                  -4.249e-01  7.670e-02  -5.540 3.13e-08 ***
## Promotion               9.140e-01  5.206e-02  17.555  < 2e-16 ***
## Age                     4.801e-03  6.322e-03   0.760  0.44757    
## EducationUndergraduate  1.778e-01  8.625e-02   2.062  0.03925 *  
## EducationPostgraduate   9.923e-02  1.289e-01   0.770  0.44148    
## Income                  1.875e-04  5.963e-05   3.144  0.00168 ** 
## Female                  3.552e-01  4.731e-02   7.508 6.71e-14 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.012 on 7492 degrees of freedom
## Multiple R-squared:  0.06298,    Adjusted R-squared:  0.06211 
## F-statistic: 71.94 on 7 and 7492 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{reg }\OtherTok{=} \FunctionTok{lm}\NormalTok{(Sales }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Price }\SpecialCharTok{+}\NormalTok{ Promotion }\SpecialCharTok{+}\NormalTok{ Age }\SpecialCharTok{+}\NormalTok{ Education }\SpecialCharTok{+}\NormalTok{ Income }\SpecialCharTok{+}\NormalTok{ Female, }\AttributeTok{data =}\NormalTok{ sales\_data)}
\FunctionTok{summary}\NormalTok{(reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Sales ~ Price + Promotion + Age + Education + Income + 
##     Female, data = sales_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.0672 -1.3370 -0.0436  1.4168  7.0909 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(>|t|)    
## (Intercept)             9.905e+00  5.352e-01  18.506  < 2e-16 ***
## Price                  -4.249e-01  7.670e-02  -5.540 3.13e-08 ***
## Promotion               9.140e-01  5.206e-02  17.555  < 2e-16 ***
## Age                     4.801e-03  6.322e-03   0.760  0.44757    
## EducationUndergraduate  1.778e-01  8.625e-02   2.062  0.03925 *  
## EducationPostgraduate   9.923e-02  1.289e-01   0.770  0.44148    
## Income                  1.875e-04  5.963e-05   3.144  0.00168 ** 
## Female                  3.552e-01  4.731e-02   7.508 6.71e-14 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.012 on 7492 degrees of freedom
## Multiple R-squared:  0.06298,    Adjusted R-squared:  0.06211 
## F-statistic: 71.94 on 7 and 7492 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Male Data}
\NormalTok{male\_data }\OtherTok{=} \FunctionTok{subset}\NormalTok{(sales\_data, Female }\SpecialCharTok{==} \DecValTok{0}\NormalTok{)}
\NormalTok{model\_male }\OtherTok{=} \FunctionTok{lm}\NormalTok{(Sales }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Price }\SpecialCharTok{+}\NormalTok{ Promotion }\SpecialCharTok{+}\NormalTok{ Age }\SpecialCharTok{+}\NormalTok{ Education }\SpecialCharTok{+}\NormalTok{ Income, }\AttributeTok{data =}\NormalTok{ male\_data)}
\FunctionTok{summary}\NormalTok{(model\_male)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Sales ~ Price + Promotion + Age + Education + Income, 
##     data = male_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.2034 -1.2901 -0.1297  1.3312  6.8298 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(>|t|)    
## (Intercept)             1.024e+01  7.655e-01  13.381  < 2e-16 ***
## Price                  -3.387e-01  1.082e-01  -3.129  0.00177 ** 
## Promotion               4.398e-01  7.347e-02   5.987 2.35e-09 ***
## Age                     1.221e-03  9.482e-03   0.129  0.89756    
## EducationUndergraduate  3.300e-01  1.238e-01   2.665  0.00773 ** 
## EducationPostgraduate   3.347e-01  1.817e-01   1.842  0.06548 .  
## Income                  5.963e-05  8.844e-05   0.674  0.50020    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 2.008 on 3743 degrees of freedom
## Multiple R-squared:  0.02176,    Adjusted R-squared:  0.02019 
## F-statistic: 13.88 on 6 and 3743 DF,  p-value: 1.146e-15
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Female Data}
\NormalTok{female\_data }\OtherTok{=} \FunctionTok{subset}\NormalTok{(sales\_data, Female }\SpecialCharTok{==} \DecValTok{1}\NormalTok{)}
\NormalTok{model\_female }\OtherTok{=} \FunctionTok{lm}\NormalTok{(Sales }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Price }\SpecialCharTok{+}\NormalTok{ Promotion }\SpecialCharTok{+}\NormalTok{ Age }\SpecialCharTok{+}\NormalTok{ Education }\SpecialCharTok{+}\NormalTok{ Income, }\AttributeTok{data =}\NormalTok{ female\_data)}
\FunctionTok{summary}\NormalTok{(model\_female)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Sales ~ Price + Promotion + Age + Education + Income, 
##     data = female_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.4577 -1.3133 -0.0223  1.4083  7.1178 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(>|t|)    
## (Intercept)             9.959e+00  7.536e-01  13.216  < 2e-16 ***
## Price                  -5.112e-01  1.074e-01  -4.758 2.03e-06 ***
## Promotion               1.388e+00  7.293e-02  19.033  < 2e-16 ***
## Age                     9.568e-03  8.616e-03   1.110 0.266874    
## EducationUndergraduate  3.087e-02  1.237e-01   0.250 0.802937    
## EducationPostgraduate  -1.620e-01  1.857e-01  -0.872 0.383127    
## Income                  3.027e-04  8.217e-05   3.684 0.000233 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.993 on 3743 degrees of freedom
## Multiple R-squared:  0.1054, Adjusted R-squared:  0.1039 
## F-statistic: 73.46 on 6 and 3743 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 2.4 What factors affect a customer\textquotesingle{}s return probability? ( Do not consider any interactions terms or use Sales as an independent variable in this regression )}
\NormalTok{reg}\OtherTok{=}\FunctionTok{glm}\NormalTok{(Return }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Price }\SpecialCharTok{+}\NormalTok{ Promotion }\SpecialCharTok{+}\NormalTok{ Age }\SpecialCharTok{+}\NormalTok{ Education }\SpecialCharTok{+}\NormalTok{ Income }\SpecialCharTok{+}\NormalTok{ Female, }\AttributeTok{family =}\NormalTok{ binomial, }\AttributeTok{data =}\NormalTok{ sales\_data)}
\FunctionTok{summary}\NormalTok{(reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = Return ~ Price + Promotion + Age + Education + 
##     Income + Female, family = binomial, data = sales_data)
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(>|z|)    
## (Intercept)             1.788e+00  6.397e-01   2.795  0.00518 ** 
## Price                   3.318e-02  9.170e-02   0.362  0.71747    
## Promotion               8.892e-01  5.939e-02  14.971  < 2e-16 ***
## Age                    -4.237e-03  7.248e-03  -0.585  0.55880    
## EducationUndergraduate -8.763e-01  9.321e-02  -9.402  < 2e-16 ***
## EducationPostgraduate  -1.678e+00  1.574e-01 -10.660  < 2e-16 ***
## Income                 -4.327e-04  7.033e-05  -6.153 7.59e-10 ***
## Female                  1.553e-02  5.587e-02   0.278  0.78109    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 9163.0  on 7499  degrees of freedom
## Residual deviance: 7974.9  on 7492  degrees of freedom
## AIC: 7990.9
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 3.1 For a customer with income=5300, age=30, female=1,education=2, what is the expected profit for the following two scenarios: }
\CommentTok{\#Qn 3.1 Part 1) price = 5, promotion = 1 }
\NormalTok{reg}\OtherTok{=}\FunctionTok{lm}\NormalTok{(Sales}\SpecialCharTok{\textasciitilde{}}\NormalTok{Price}\SpecialCharTok{+}\NormalTok{Promotion}\SpecialCharTok{+}\NormalTok{Age}\SpecialCharTok{+}\NormalTok{Education}\SpecialCharTok{+}\NormalTok{Income}\SpecialCharTok{+}\NormalTok{Female,}\AttributeTok{data=}\NormalTok{sales\_data)}
\NormalTok{discount}\OtherTok{=}\FloatTok{0.3}
\NormalTok{unit\_cost}\OtherTok{=}\FloatTok{2.5}
\NormalTok{customer\_1 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Income =} \DecValTok{5300}\NormalTok{, }\AttributeTok{Age =} \DecValTok{30}\NormalTok{, }\AttributeTok{Female =} \DecValTok{1}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Undergraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)), }\AttributeTok{Price =} \DecValTok{5}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{1}\NormalTok{)}
\NormalTok{predicted\_sales\_1 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(reg, customer\_1)}
\NormalTok{profit\_1 }\OtherTok{=}\NormalTok{ predicted\_sales\_1 }\SpecialCharTok{*}\NormalTok{ ((customer\_1}\SpecialCharTok{$}\NormalTok{Price }\SpecialCharTok{{-}}\NormalTok{ (customer\_1}\SpecialCharTok{$}\NormalTok{Promotion }\SpecialCharTok{*}\NormalTok{ discount)) }\SpecialCharTok{{-}}\NormalTok{ unit\_cost)}
\FunctionTok{print}\NormalTok{(profit\_1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 22.80278
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 3.1 Part 2) price = 4.8}
\NormalTok{customer\_2 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Income =} \DecValTok{5300}\NormalTok{, }\AttributeTok{Age =} \DecValTok{30}\NormalTok{, }\AttributeTok{Female =} \DecValTok{1}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Undergraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)), }\AttributeTok{Price =} \FloatTok{4.8}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{0}\NormalTok{)}
\NormalTok{predicted\_sales\_2 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(reg, customer\_2)}
\NormalTok{profit\_2 }\OtherTok{=}\NormalTok{ predicted\_sales\_2 }\SpecialCharTok{*}\NormalTok{ ((customer\_2}\SpecialCharTok{$}\NormalTok{Price }\SpecialCharTok{{-}}\NormalTok{ (customer\_2}\SpecialCharTok{$}\NormalTok{Promotion }\SpecialCharTok{*}\NormalTok{ discount)) }\SpecialCharTok{{-}}\NormalTok{ unit\_cost)}
\FunctionTok{print}\NormalTok{(profit\_2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 21.93265
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 3.2 Part 1) price = 5, promotion = 1 }
\NormalTok{customer\_3 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Income =} \DecValTok{5300}\NormalTok{, }\AttributeTok{Age =} \DecValTok{30}\NormalTok{, }\AttributeTok{Female =} \DecValTok{0}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Undergraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)), }\AttributeTok{Price =} \DecValTok{5}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{1}\NormalTok{)}
\NormalTok{predicted\_sales\_3 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(reg, customer\_3)}
\NormalTok{profit\_3 }\OtherTok{=}\NormalTok{ predicted\_sales\_3 }\SpecialCharTok{*}\NormalTok{ ((customer\_3}\SpecialCharTok{$}\NormalTok{Price }\SpecialCharTok{{-}}\NormalTok{ (customer\_3}\SpecialCharTok{$}\NormalTok{Promotion }\SpecialCharTok{*}\NormalTok{ discount)) }\SpecialCharTok{{-}}\NormalTok{ unit\_cost)}
\FunctionTok{print}\NormalTok{(profit\_3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 22.02143
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 3.2 Part 2) price = 4.8, promotion = 0}
\NormalTok{customer\_4 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Income =} \DecValTok{5300}\NormalTok{, }\AttributeTok{Age =} \DecValTok{30}\NormalTok{, }\AttributeTok{Female =} \DecValTok{0}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Undergraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)), }\AttributeTok{Price =} \FloatTok{4.8}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{0}\NormalTok{)}
\NormalTok{predicted\_sales\_4 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(reg, customer\_4)}
\NormalTok{profit\_4 }\OtherTok{=}\NormalTok{ predicted\_sales\_4 }\SpecialCharTok{*}\NormalTok{ ((customer\_4}\SpecialCharTok{$}\NormalTok{Price }\SpecialCharTok{{-}}\NormalTok{ (customer\_4}\SpecialCharTok{$}\NormalTok{Promotion }\SpecialCharTok{*}\NormalTok{ discount)) }\SpecialCharTok{{-}}\NormalTok{ unit\_cost)}
\FunctionTok{print}\NormalTok{(profit\_4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 21.11578
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 4}
\NormalTok{customer\_data }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Customer\_demographics.csv"}\NormalTok{)}
\NormalTok{sales\_data }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Sales.csv"}\NormalTok{)}

\NormalTok{sales\_data}\SpecialCharTok{$}\NormalTok{Education }\OtherTok{=} \FunctionTok{factor}\NormalTok{(sales\_data}\SpecialCharTok{$}\NormalTok{Education, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{), }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{))}
\NormalTok{return\_logit }\OtherTok{=} \FunctionTok{glm}\NormalTok{(Return}\SpecialCharTok{\textasciitilde{}}\NormalTok{Price}\SpecialCharTok{+}\NormalTok{Promotion}\SpecialCharTok{+}\NormalTok{Age}\SpecialCharTok{+}\NormalTok{Education}\SpecialCharTok{+}\NormalTok{Income}\SpecialCharTok{+}\NormalTok{Female, }\AttributeTok{data =}\NormalTok{ sales\_data, }\AttributeTok{family =} \StringTok{\textquotesingle{}binomial\textquotesingle{}}\NormalTok{)}
\NormalTok{sales\_reg }\OtherTok{=} \FunctionTok{lm}\NormalTok{(}\FunctionTok{log}\NormalTok{(Sales)}\SpecialCharTok{\textasciitilde{}}\FunctionTok{log}\NormalTok{(Price)}\SpecialCharTok{+}\NormalTok{ Promotion }\SpecialCharTok{+}\NormalTok{ Age }\SpecialCharTok{+} \FunctionTok{log}\NormalTok{(Income)}\SpecialCharTok{+}\NormalTok{ Female }\SpecialCharTok{+}\NormalTok{ Education, }\AttributeTok{data =}\NormalTok{ sales\_data)}
\FunctionTok{summary}\NormalTok{(return\_logit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = Return ~ Price + Promotion + Age + Education + 
##     Income + Female, family = "binomial", data = sales_data)
## 
## Coefficients:
##                          Estimate Std. Error z value Pr(>|z|)    
## (Intercept)             1.788e+00  6.397e-01   2.795  0.00518 ** 
## Price                   3.318e-02  9.170e-02   0.362  0.71747    
## Promotion               8.892e-01  5.939e-02  14.971  < 2e-16 ***
## Age                    -4.237e-03  7.248e-03  -0.585  0.55880    
## EducationUndergraduate -8.763e-01  9.321e-02  -9.402  < 2e-16 ***
## EducationPostgraduate  -1.678e+00  1.574e-01 -10.660  < 2e-16 ***
## Income                 -4.327e-04  7.033e-05  -6.153 7.59e-10 ***
## Female                  1.553e-02  5.587e-02   0.278  0.78109    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 9163.0  on 7499  degrees of freedom
## Residual deviance: 7974.9  on 7492  degrees of freedom
## AIC: 7990.9
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(sales\_reg)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = log(Sales) ~ log(Price) + Promotion + Age + log(Income) + 
##     Female + Education, data = sales_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.48577 -0.12572  0.02079  0.16546  0.59768 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(>|t|)    
## (Intercept)             1.7495700  0.3073435   5.693 1.30e-08 ***
## log(Price)             -0.2354954  0.0432573  -5.444 5.37e-08 ***
## Promotion               0.0985177  0.0059280  16.619  < 2e-16 ***
## Age                     0.0005713  0.0007252   0.788   0.4309    
## log(Income)             0.0899912  0.0350248   2.569   0.0102 *  
## Female                  0.0375644  0.0053911   6.968 3.49e-12 ***
## EducationUndergraduate  0.0230570  0.0100670   2.290   0.0220 *  
## EducationPostgraduate   0.0176349  0.0147285   1.197   0.2312    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.2293 on 7492 degrees of freedom
## Multiple R-squared:  0.05687,    Adjusted R-squared:  0.05599 
## F-statistic: 64.54 on 7 and 7492 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 4.1 Part 1) income=5300, age=30,female=1,education=2}
\NormalTok{customer1 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Price =} \DecValTok{5}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{1}\NormalTok{, }\AttributeTok{Income =} \DecValTok{5300}\NormalTok{, }\AttributeTok{Age=}\DecValTok{30}\NormalTok{, }\AttributeTok{Female=}\DecValTok{1}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Undergraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)))}
\NormalTok{sales1 }\OtherTok{=} \FunctionTok{exp}\NormalTok{(}\FunctionTok{predict}\NormalTok{(sales\_reg,customer1)) }\CommentTok{\#10.1}
\NormalTok{profit1 }\OtherTok{=}\NormalTok{ sales1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{5}\FloatTok{{-}2.5{-}0.3}\NormalTok{) }\CommentTok{\#22.22193}
\NormalTok{profit1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 22.35398
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prob\_return1 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(return\_logit, customer1, }\AttributeTok{type =} \StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{) }\CommentTok{\#0.3952867 }
\NormalTok{expected\_profit1}\OtherTok{=}\NormalTok{ profit1}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ prob\_return1)}\SpecialCharTok{+}\NormalTok{(sales1}\SpecialCharTok{*}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{prob\_return1 }\CommentTok{\#9.445153 }
\NormalTok{expected\_profit1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       1 
## 9.60371
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 4.1 Part 2) income=5300, age=30,female=1,education=2}
\NormalTok{customer2 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Price =} \FloatTok{4.8}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{0}\NormalTok{, }\AttributeTok{Income =} \DecValTok{5300}\NormalTok{, }\AttributeTok{Age=}\DecValTok{30}\NormalTok{, }\AttributeTok{Female=}\DecValTok{1}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Undergraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)))}
\NormalTok{sales2 }\OtherTok{=} \FunctionTok{exp}\NormalTok{(}\FunctionTok{predict}\NormalTok{(sales\_reg, customer2)) }\CommentTok{\#9.241626 }
\NormalTok{profit2 }\OtherTok{=}\NormalTok{ sales2 }\SpecialCharTok{*}\NormalTok{ (}\FloatTok{4.8{-}2.5}\NormalTok{) }\CommentTok{\#21.25574 }
\NormalTok{profit2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 21.38206
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prob\_return2 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(return\_logit, customer2, }\AttributeTok{type =} \StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{) }\CommentTok{\#0.210729 }
\NormalTok{prob\_return2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         1 
## 0.2084695
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{expected\_profit2}\OtherTok{=}\NormalTok{ profit2}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ prob\_return2)}\SpecialCharTok{+}\NormalTok{(sales2}\SpecialCharTok{*}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{prob\_return2 }\CommentTok{\#14.82906 }


\NormalTok{expected\_profit2 }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       1 
## 14.9865
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 4.2 Part 1) INCOME = 8500, AGE= 30, FEMALE = 1, EDUCATION=3}
\NormalTok{customer3 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Price =} \DecValTok{5}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{1}\NormalTok{, }\AttributeTok{Income =} \DecValTok{8500}\NormalTok{, }\AttributeTok{Age=}\DecValTok{30}\NormalTok{, }\AttributeTok{Female=}\DecValTok{1}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Postgraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)))}
\NormalTok{sales3 }\OtherTok{=} \FunctionTok{exp}\NormalTok{(}\FunctionTok{predict}\NormalTok{(sales\_reg, customer3))}
\NormalTok{sales3 }\CommentTok{\#10.64717 }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       1 
## 10.5448
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{profit3 }\OtherTok{=}\NormalTok{ sales3 }\SpecialCharTok{*}\NormalTok{ (}\DecValTok{5}\FloatTok{{-}2.5{-}0.3}\NormalTok{) }\CommentTok{\#23.42378 }
\NormalTok{profit3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 23.19857
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prob\_return3 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(return\_logit, customer3, }\AttributeTok{type =} \StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{) }\CommentTok{\#0.06577799 }
\NormalTok{prob\_return3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          1 
## 0.06758859
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{expected\_profit3}\OtherTok{=}\NormalTok{ profit3}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ prob\_return3)}\SpecialCharTok{+}\NormalTok{(sales3}\SpecialCharTok{*}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{prob\_return3 }\CommentTok{\#21.18266 }
\NormalTok{expected\_profit3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       1 
## 20.9179
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Qn 4.2 Part 2) INCOME = 8500, AGE= 30, FEMALE = 1, EDUCATION=3}
\NormalTok{customer4 }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Price =} \FloatTok{4.8}\NormalTok{, }\AttributeTok{Promotion =} \DecValTok{0}\NormalTok{, }\AttributeTok{Income =} \DecValTok{8500}\NormalTok{, }\AttributeTok{Age=}\DecValTok{30}\NormalTok{, }\AttributeTok{Female=}\DecValTok{1}\NormalTok{, }\AttributeTok{Education =} \FunctionTok{factor}\NormalTok{(}\StringTok{"Postgraduate"}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"High School"}\NormalTok{, }\StringTok{"Undergraduate"}\NormalTok{, }\StringTok{"Postgraduate"}\NormalTok{)))}
\NormalTok{sales4 }\OtherTok{=} \FunctionTok{exp}\NormalTok{(}\FunctionTok{predict}\NormalTok{(sales\_reg, customer4))}
\NormalTok{sales4 }\CommentTok{\#9.741449 }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 9.647791
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{profit4 }\OtherTok{=}\NormalTok{ sales4 }\SpecialCharTok{*}\NormalTok{ (}\FloatTok{4.8{-}2.5}\NormalTok{) }\CommentTok{\#22.40533 }
\NormalTok{profit4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 22.18992
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{prob\_return4 }\OtherTok{=} \FunctionTok{predict}\NormalTok{(return\_logit, customer4, }\AttributeTok{type =} \StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{) }\CommentTok{\#0.02795455 }
\NormalTok{prob\_return4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          1 
## 0.02874375
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{expected\_profit4}\OtherTok{=}\NormalTok{ profit4}\SpecialCharTok{*}\NormalTok{(}\DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ prob\_return4) }\SpecialCharTok{+}\NormalTok{ (sales4 }\SpecialCharTok{*}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}\SpecialCharTok{*}\NormalTok{prob\_return4 }\CommentTok{\#21.50668 }
\NormalTok{expected\_profit4 }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##        1 
## 21.27478
\end{verbatim}

\end{document}
